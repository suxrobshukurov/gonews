# Gonews

Gonews — это веб-приложение на Go, которое периодически парсит RSS-ленты, сохраняет данные о публикациях в базу данных (PostgreSQL или in-memory) и предоставляет API для получения публикаций.

## Функциональность

- Периодический запрос к заданным RSS-источникам.
- Сохранение публикаций в базе данных (PostgreSQL или in-memory).
- API для получения публикаций с возможностью указания количества.
- Веб-интерфейс для отображения публикаций.

## Структура проекта

- `pkg/api/`: обработка HTTP-запросов и маршрутизация через Gorilla Mux.
  - **api.go** — содержит API-эндпоинты для получения публикаций и обслуживания веб-приложения.
- `pkg/rss/`: парсинг RSS-лент и преобразование данных.
  - **rss.go** — парсинг RSS, извлечение информации и её преобразование в объекты `Post`.
- `pkg/storage/`: интерфейс для работы с хранилищем данных.
  - **storage.go** — определяет структуру `Post` и интерфейс для работы с хранилищем.
  - **memdb/** — реализация in-memory базы данных.
  - **postgres/** — реализация хранения в PostgreSQL.
- `webapp/`: фронтенд для отображения данных.
  - **index.html** — веб-интерфейс для работы с приложением.
- `config.json` — конфигурационный файл, содержащий URL-адреса RSS-лент и период запросов.
- `.env-example` — пример файла с переменными окружения для подключения к PostgreSQL.

## Установка и запуск

### 1. Клонирование репозитория

```bash
git clone https://github.com/suxrobshukurov/gonews.git
cd gonews
```

### 2. Установка зависимостей

```bash
go mod tidy
```

### 3. Тестирование

Для запуска тестов используйте команду:
Перед тестом добавьте в переменную окружения `connstr` вашу строку подключения к базе данных:
```bash 
export connstr=postgres://postgres:password@localhost:5432/gonews?sslmode=disable
```

Затем запустите тесты:
```bash
go test ./... -v --cover
```

### 4. Настройка конфигурации
Перейти в каталог с исполняемым пакетом:
```bash 
cd cmd/gonews
```
Создайте файл `.env` на основе `.env-example` и укажите свои данные для подключения к базе данных PostgreSQL (если не удаста подключиться к базе PostgreSQL, приложение запуститься без подключения к базе данных с использованием in-memory):

```bash
cp .env-example .env
```

Заполните переменную `connstr` в файле `.env` следующим образом:

```
connstr=postgres://postgres:password@localhost:5432/gonews?sslmode=disable
```

### 5. Настройка `config.json`

В файле `config.json` укажите URL-адреса RSS-лент и интервал запросов (в минутах):

```json
{
  "rss": [
    "https://habr.com/ru/rss/hub/go/all/?fl=ru",
    "https://habr.com/ru/rss/best/daily/?fl=ru",
    "https://cprss.s3.amazonaws.com/golangweekly.com.xml"
  ],
  "request_period": 30
}

```

### 5. Запуск приложения

Для запуска приложения выполните:

```bash
go run gonews.go
```

## API Эндпоинты

- `GET /news/n/` — n - число публикаций, которые необходимо получить.
- `GET /` — веб-интерфейс для просмотра публикаций.

## Используемые технологии

- Go (Golang)
- PostgreSQL
- Gorilla Mux для маршрутизации
- HTML/CSS/JavaScript для фронтенда

## Контакт

Если у вас возникли вопросы, вы можете связаться с автором по электронной почте: suxrob-1124@yandex.ru